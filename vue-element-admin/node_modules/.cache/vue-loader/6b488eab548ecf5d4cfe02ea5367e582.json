{"remainingRequest":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/src/views/index/setting/upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/src/views/index/setting/upload.vue","mtime":1608889401538},{"path":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenjiahao/GoDemo/go-blog/vue-element-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport axios from 'axios'\nimport { MessageBox, Message } from 'element-ui'\nimport store from '@/store'\nimport { getToken } from '@/utils/auth'\nimport { httphost } from '@/utils/global'\n \nimport { UpdateIndexPics,GetIndexPics} from '@/api/setting'\n\nexport default {\n  name: 'SettingUplaod',\n  data() {\n    return{\n      dialogImageUrl: '',\n      dialogVisible: false,\n      formLabelWidth: '80px',\n      limitNum: 5,\n      form: {},\n      upload_url:httphost + '/upload/image?token='+getToken(),\n      fileList : []\n    }\n  },\n \n    computed: {\n \n    },\n\n\n  created() {\n\n\n        GetIndexPics( ).then(response => {\n          this.fileList  =  response.data \n \n\n        }).catch(err => {\n          console.log(err)\n        })\n  },\n\n\n  methods: {\n \n  \tclearFile(){\n  \t\t  this.fileList = []\n  \t},\n  \tsubmitFile(){\n  \t\tconsole.log(  this.fileList )\n \n        UpdateIndexPics({imgs:this.fileList}).then(response => {\n          this.postForm = response.data\n\n                   this.$notify({\n                title: 'Success',\n                dangerouslyUseHTMLString: true,\n                message: '修改成功',\n                type: 'success',\n                duration: 2000\n              })\n        }).catch(err => {\n          console.log(err)\n        })\n\n  \t},\n  \tuploadSectionFile (params) {\n  \t\tconsole.log(params)\n\n  \t\t    var self = this,\n            file = params.file,\n            fileType = file.type,         \n            file_url = self.$refs.upload.uploadFiles[0].url;\n\n            var img = new Image();\n            img.src = file_url;\n            img.onload = function () {               \n              self.uploadFile11(file  );\n            }\n \n\n  \t},\n\n    uploadFile11: function (file ) {\n        var self = this,\n            formData = new FormData();\n        formData.append( 'file', file);\n\n \n        axios.post(self.upload_url, formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n            .then(function (res) {\n\n            \tif(res.data.code == 20000){\n                     \n \n\n                      self.fileList .push({\n                      \tname:res.data.data,\n                      \turl:res.data.data\n                      })\n\n\n            \t}else{\n            \t\t  _.$alert('上传失败，请重新上传', '提示', { type: 'error' });\n            \t}\n\n            \t \n\t\t\t    //  self.$refs.upload.uploadFiles = []; \n            })\n            .catch(function (err) {\n               \n            });\n         \n    },\n\n\n\n    // 上传文件之前的钩子\n    handleBeforeUpload(file){\n      console.log('before')\n      if(!(file.type === 'image/png' || file.type === 'image/gif' || file.type === 'image/jpg' || file.type === 'image/jpeg')) {\n        this.$notify.warning({\n          title: '警告',\n          message: '请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片'\n        })\n      }\n      let size = file.size / 1024 / 1024 / 2\n      if(size > 2) {\n        this.$notify.warning({\n          title: '警告',\n          message: '图片大小必须小于2M'\n        })\n      }\n    },\n    // 文件超出个数限制时的钩子\n    handleExceed(files, fileList) {\n\n    },\n    // 文件列表移除文件时的钩子\n    handleRemove(file, fileList) {\n    \t this.fileList = fileList\n\n      console.log( this.fileList);\n    },\n    // 点击文件列表中已上传的文件时的钩子\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n   \n    uploadFile() {\n      this.$refs.upload.submit()\n    }\n     \n  } \n}\n",null]}